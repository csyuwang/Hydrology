var Viewport = function (editor) {    var signals = editor.signals;    var gridHelper = editor.gridHelper;    // UI    var container = new EditorUI.Panel();    var canvasStyle = Config.Canvas.Style;    var canvas = new EditorUI.Canvas(canvasStyle.width,canvasStyle.height);    canvas.setBackgroundColor(canvasStyle.backgroundColor);    canvas.setPosition(canvasStyle.top,canvasStyle.left);    container.add(canvas);    // handle signals    // 窗口改变重新设置画布大小    signals.windowResize.add( function () {        canvas.setSize(window.innerHeight - 64,window.innerHeight - 64);        gridHelper.canvasWidth = canvas.getOffsetWidth();        gridHelper.canvasHeight = canvas.getOffsetHeight();        //gridHelper.drawXYGrid(canvas);    } );    // 项目初始化完成时    signals.projectInitialized.add(function (projectId) {        $.ajax({            type: 'GET',            contentType: 'application/json',            url: '../getdata/getXYGrids.json',            data: { 'projectId': projectId },            dataType: 'json',            success: function (grid) {                gridHelper.xCoordinates = grid.xCoordinates;                gridHelper.yCoordinates = grid.yCoordinates;                gridHelper.zCoordinates = grid.zCoordinates;                //默认初始化XY方向网格                gridHelper.drawXYGrid(canvas);            }        });    });    signals.viewLayer.add(function () {        gridHelper.drawXYGrid(canvas);    });    signals.viewRow.add(function () {        gridHelper.drawXZGrid(canvas);    });    signals.viewColumn.add(function () {        gridHelper.drawYZGrid(canvas);    });    // 层改变时画出XY方向所有Block    signals.layerChanged.add(function (projectId,propertyType,layer) {        //alert(projectId+','+propertyType+','+layer);        $.ajax({            type: 'GET',            contentType: 'application/json',            url: '../getdata/getBlocks.json',            data: { 'projectId': projectId,'propertyType': propertyType, 'layer':layer},            dataType: 'json',            success: function (blocks) {                gridHelper.drawBlocks(canvas,blocks);            }        });    });    // 行改变时画出XZ方向所有Block    signals.rowChanged.add(function (projectId,propertyType,row) {    });    // 列改变时画出YZ方向所有Block    signals.columnChanged.add(function (projectId,propertyType,column) {    });    return container;};